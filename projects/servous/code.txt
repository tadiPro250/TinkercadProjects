// C++ code
//
#include<Servo.h>
Servo s;
int trig1=7;
int trig2=5;
int echo1=6;
int echo2=4;
int distance1=0;
int distance2=0;
int duration1=0;
int duration2=0;
int switchstate=0;
int switchpin=8;
int initialp=0;
void setup()
{
  pinMode(trig1, OUTPUT);
  pinMode(trig2,OUTPUT);
  pinMode(echo1,INPUT);
  pinMode(echo2,INPUT);
  pinMode(switchpin,INPUT_PULLUP);
  s.attach(3);
  Serial.begin(9600);
}

void loop()
{
  switchstate=digitalRead(switchpin);
  if (switchstate == LOW)
  {
    initialpos();
  }
  else
  {
    speed();
    s.write(initialp);
  }
}
void initialpos ()
{
  digitalWrite(trig1,LOW);
  digitalWrite(trig2,LOW);
  delay(50);
  digitalWrite(trig1,HIGH);
  delayMicroseconds(10);
  digitalWrite(trig1,LOW);
  duration1=pulseIn(echo1,HIGH);
  distance1=duration1*0.0343/2;
  Serial.print("Distance measured in U1:");
  Serial.print(distance1);
  Serial.println("cm");
  if(distance1<200)
  {
    initialp=0;
    s.write(0);
  }
  else
  {
    initialp=180;
    s.write(180);
  }
}
void speed()
{
  digitalWrite(trig2,HIGH);
  delayMicroseconds(10);
  digitalWrite(trig2,LOW);
  duration2=pulseIn(echo2,HIGH);
  distance2=duration2*0.0343/2;
  Serial.print("Distance measured in U2: ");
  Serial.print(distance2);
  Serial.println("cm");
  int speed=map(distance2,0,335,0,255);
  analogWrite(3,speed);
}